"""Searchsploit Exploit-DB command line search"""

from typing import Dict, Any


def register_searchsploit_tool(mcp, kali_client):
    """Register the Searchsploit tool with the MCP server"""
    
    @mcp.tool()
    def searchsploit_search(query: str, exact: bool = False, json_output: bool = True, additional_args: str = "") -> Dict[str, Any]:
        """
        Execute Searchsploit to search for exploits.
        
        Args:
            query: Search query (software name, CVE, etc.)
            exact: Use exact match
            json_output: Return results in JSON format
            additional_args: Additional Searchsploit arguments
            
        Returns:
            Search results
        """
        data = {
            "query": query,
            "exact": exact,
            "json_output": json_output,
            "additional_args": additional_args
        }
        return kali_client.safe_post("api/tools/searchsploit", data)

