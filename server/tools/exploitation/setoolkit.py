"""Social-Engineer Toolkit (SET)"""

from typing import Dict, Any


def register_setoolkit_tool(mcp, kali_client):
    """Register the Social-Engineer Toolkit with the MCP server"""
    
    @mcp.tool()
    def setoolkit_run(attack_vector: str, payload: str = "", target: str = "", additional_args: str = "") -> Dict[str, Any]:
        """
        Execute Social-Engineer Toolkit attacks.
        
        Args:
            attack_vector: Attack vector to use (spear_phishing, web_attack, etc.)
            payload: Payload to deliver
            target: Target specification
            additional_args: Additional SET arguments
            
        Returns:
            Attack results
        """
        data = {
            "attack_vector": attack_vector,
            "payload": payload,
            "target": target,
            "additional_args": additional_args
        }
        return kali_client.safe_post("api/tools/setoolkit", data)

